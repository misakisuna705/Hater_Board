var config={apiKey:"AIzaSyCIg9T5jx3bzpgIClMjnNIGRD8Wd0gfrfI",authDomain:"hater-board.firebaseapp.com",databaseURL:"https://hater-board.firebaseio.com",projectId:"hater-board",storageBucket:"hater-board.appspot.com",messagingSenderId:"528205002613"};firebase.initializeApp(config);
let dom_edit_button,dom_edit_icon,dom_post_edit_box,dom_post_summit,dom_post_type,dom_post_title,dom_post_content,dom_push_edit_box,dom_push_summit,dom_push_content;function edit_select(){"board"==cur_pos?"none"==dom_post_edit_box.style.display?(top_box_hide(),post_list("hide"),post_edit_box("show"),dom_edit_icon.classList.remove("fa-pen"),dom_edit_icon.classList.add("fa-times")):(top_box_show(),post_list("show"),post_edit_box("hide"),dom_edit_icon.classList.remove("fa-times"),dom_edit_icon.classList.add("fa-pen")):"post"==cur_pos&&("none"==dom_push_edit_box.style.display?(top_box_hide(),push_list("hide"),push_edit_box("show"),dom_edit_icon.classList.remove("fa-pen"),dom_edit_icon.classList.add("fa-times")):(top_box_show(),push_list("show"),push_edit_box("hide"),dom_edit_icon.classList.remove("fa-times"),dom_edit_icon.classList.add("fa-pen")))}function post_edit_box(t){switch(t){case"hide":dom_post_edit_box.style.display="none",dom_post_type.value="",dom_post_title.value="",dom_post_content.value="";break;case"show":dom_post_edit_box.style.display="block"}}function push_edit_box(t){switch(t){case"hide":dom_push_edit_box.style.display="none",dom_push_content.value="";break;case"show":dom_push_edit_box.style.display="block"}}function edit_post_summit(){if(""!=dom_post_type.value&&""!=dom_post_title.value&&""!=dom_post_content.value){let t={user:user_email,type:dom_post_type.value,title:dom_post_title.value,content:dom_post_content.value};firebase.database().ref(cur_room).push(t),top_box_show(),post_list("show"),post_edit_box("hide"),dom_edit_icon.classList.remove("fa-times"),dom_edit_icon.classList.add("fa-pen")}else alert("Cannot be blank!")}function edit_push_summit(){if("push_summit"!=event.target.id)if(""!=dom_push_content.value){let t="平";switch(event.target.id){case"push_good":t="推";break;case"push_bad":t="噓";break;case"push_soso":t="平"}let o={user:user_email,type:t,content:dom_push_content.value};firebase.database().ref(cur_room+"/"+cur_post).push(o),top_box_show(),push_list("show"),push_edit_box("hide"),dom_edit_icon.classList.remove("fa-times"),dom_edit_icon.classList.add("fa-pen")}else alert("Cannot be blank!")}
let cur_pos,cur_room,cur_post;function init(){sign_init(),room_init(),top_box_init(),post_init(),edit_init(),room_rwd(),window.addEventListener("resize",room_rwd,!1),firebase.auth().onAuthStateChanged(e=>{e?(top_box_update(cur_pos="station"),dom_user_state.innerText="Logout",user_email=e.email,dom_room.addEventListener("click",board_select,!1),dom_room_next.addEventListener("click",board_select,!1),dom_post_list.addEventListener("click",post_select,!1),dom_edit_button.addEventListener("click",edit_select,!1),dom_post_summit.addEventListener("click",edit_post_summit,!1),dom_push_summit.addEventListener("click",edit_push_summit,!1),dom_user_account.addEventListener("click",auth_show,!1),dom_user_state.addEventListener("click",sign_out,!1)):(dom_logbox.style.display="block",dom_user_state.innerText="Login",dom_facebook_sign_in.addEventListener("click",sign_facebook,!1),dom_google_sign_in.addEventListener("click",sign_google,!1),dom_email_login.addEventListener("click",sign_email,!1),dom_email_sign_up.addEventListener("click",sign_up,!1))})}function sign_init(){dom_user_state=document.getElementById("user_state"),dom_user_account=document.getElementById("user_account"),dom_logbox=document.getElementById("logbox"),dom_facebook_sign_in=document.getElementById("facebook_sign_in"),dom_google_sign_in=document.getElementById("google_sign_in"),dom_email_login=document.getElementById("email_login"),dom_email_sign_up=document.getElementById("email_sign_up"),dom_email=document.getElementById("email"),dom_password=document.getElementById("password")}function room_init(){dom_room=document.getElementsByClassName("room")[0],dom_beauty=document.getElementsByClassName("beauty")[0],dom_boy_girl=document.getElementsByClassName("boy_girl")[0],dom_c_chat=document.getElementsByClassName("c_chat")[0],dom_gossiping=document.getElementsByClassName("gossiping")[0],dom_joke=document.getElementsByClassName("joke")[0],dom_lifeismoney=document.getElementsByClassName("lifeismoney")[0],dom_stock=document.getElementsByClassName("stock")[0],dom_stupidclown=document.getElementsByClassName("stupidclown")[0],dom_room_next=document.getElementsByClassName("room_next")[0],dom_beauty_next=document.getElementsByClassName("beauty_next")[0],dom_boy_girl_next=document.getElementsByClassName("boy_girl_next")[0],dom_c_chat_next=document.getElementsByClassName("c_chat_next")[0],dom_gossiping_next=document.getElementsByClassName("gossiping_next")[0],dom_joke_next=document.getElementsByClassName("joke_next")[0],dom_lifeismoney_next=document.getElementsByClassName("lifeismoney_next")[0],dom_stock_next=document.getElementsByClassName("stock_next")[0],dom_stupidclown_next=document.getElementsByClassName("stupidclown_next")[0]}function post_init(){dom_post_list=document.getElementById("post_list")}function edit_init(){dom_push_list=document.getElementById("push_list"),dom_edit_button=document.getElementById("edit_button"),dom_edit_icon=document.getElementById("edit_icon"),dom_post_edit_box=document.getElementById("post_edit_box"),dom_push_edit_box=document.getElementById("push_edit_box"),dom_post_summit=document.getElementById("post_summit"),dom_push_summit=document.getElementById("push_summit"),dom_post_type=document.getElementById("post_type"),dom_post_title=document.getElementById("post_title"),dom_post_content=document.getElementById("post_content"),dom_push_content=document.getElementById("push_content")}window.addEventListener("DOMContentLoaded",init,!1);
let dom_post_list,dom_room,dom_beauty,dom_boy_girl,dom_c_chat,dom_gossiping,dom_joke,dom_lifeismoney,dom_stock,dom_stupidclown,dom_room_next,dom_beauty_next,dom_boy_girl_next,dom_c_chat_next,dom_gossiping_next,dom_joke_next,dom_lifeismoney_next,dom_stock_next,dom_stupidclown_next;function room_rwd(){document.body.clientWidth<1024?(dom_room.style.display="none",dom_room_next.style.display="flex",dom_beauty.id="beauty_next",dom_boy_girl.id="boy_girl_next",dom_c_chat.id="c_chat_next",dom_gossiping.id="gossiping_next",dom_joke.id="joke_next",dom_lifeismoney.id="lifeismoney_next",dom_stock.id="stock_next",dom_stupidclown.id="stupidclown_next",dom_beauty_next.id="beauty",dom_boy_girl_next.id="boy_girl",dom_c_chat_next.id="c_chat",dom_gossiping_next.id="gossiping",dom_joke_next.id="joke",dom_lifeismoney_next.id="lifeismoney",dom_stock_next.id="stock",dom_stupidclown_next.id="stupidclown"):(dom_room.style.display="flex",dom_room_next.style.display="none",dom_beauty.id="beauty",dom_boy_girl.id="boy_girl",dom_c_chat.id="c_chat",dom_gossiping.id="gossiping",dom_joke.id="joke",dom_lifeismoney.id="lifeismoney",dom_stock.id="stock",dom_stupidclown.id="stupidclown",dom_beauty_next.id="beauty_next",dom_boy_girl_next.id="boy_girl_next",dom_c_chat_next.id="c_chat_next",dom_gossiping_next.id="gossiping_next",dom_joke_next.id="joke_next",dom_lifeismoney_next.id="lifeismoney_next",dom_stock_next.id="stock_next",dom_stupidclown_next.id="stupidclown_next")}function post_list(o){switch(o){case"clear":dom_post_list.innerHTML="";break;case"listen":firebase.database().ref(cur_room).on("value",o=>{dom_post_list.innerHTML="",o.forEach(o=>{dom_post_list.innerHTML+="<a class='mb-2 rounded list-group-item list-group-item-action' id='"+o.key+"' href='#'>[ "+o.val().type+" ] - "+o.val().title+" - ( "+o.val().user+" )</a>\n"})});break;case"hide":dom_post_list.style.display="none";break;case"show":dom_post_list.style.display="flex"}}
let dom_push_list;function push_list(e){switch(e){case"clear":dom_push_list.innerHTML="";break;case"listen":firebase.database().ref(cur_room+"/"+cur_post).on("value",e=>{dom_push_list.innerHTML="",e.forEach(e=>{"user"!=e.key&&"type"!=e.key&&"title"!=e.key&&"content"!=e.key&&(dom_push_list.innerHTML+="<a class='my-1 rounded list-group-item list-group-item-action' id='"+e.key+"' href='#'>[ "+e.val().type+" ] - "+e.val().content+" - ("+e.val().user+" )</a>\n")})});break;case"hide":dom_push_list.style.display="none";break;case"show":dom_push_list.style.display="flex"}}
function board_select(){let t;cur_pos="board",document.getElementsByClassName("nav_list")[0].classList.remove("show"),cur_room&&(t=cur_room),t&&document.getElementById(t).classList.remove("active"),cur_room=event.target.id,document.getElementById(cur_room).classList.add("active"),top_box_update(cur_pos),post_list("listen"),post_list("show"),push_list("hide"),post_edit_box("hide"),push_edit_box("hide"),dom_edit_icon.classList.remove("fa-times"),dom_edit_icon.classList.add("fa-pen"),dom_edit_button.style.display="block"}function post_select(){"post_list"!=event.target.id&&"post"!=cur_pos&&(cur_pos="post",cur_post=event.target.id,top_box_update(cur_pos),push_list("listen"),post_list("hide"),push_list("show"))}
let user_email,dom_user_state,dom_user_account,dom_logbox,dom_facebook_sign_in,dom_google_sign_in,dom_email_login,dom_email_sign_up,dom_email,dom_password;function sign_up(){firebase.auth().createUserWithEmailAndPassword(dom_email.value,dom_password.value).then(e=>{alert("Success!"),dom_email.value="",dom_password.value="",auth_build(e.user)}).catch(e=>{alert(e.message),dom_email.value="",dom_password.value=""})}function sign_facebook(){let e=new firebase.auth.FacebookAuthProvider;firebase.auth().signInWithPopup(e).then(e=>{auth_build(e.user)}).catch(e=>{alert(e.message)})}function sign_google(){let e=new firebase.auth.GoogleAuthProvider;firebase.auth().signInWithPopup(e).then(e=>{auth_build(e.user)}).catch(e=>{alert(e.message)})}function sign_email(){firebase.auth().signInWithEmailAndPassword(dom_email.value,dom_password.value).then(e=>{auth_update(e.user)}).catch(e=>{alert(e.message),dom_email.value="",dom_password.value=""})}function sign_out(){firebase.auth().signOut().then(()=>{window.location.reload("index.html")}).catch(e=>{alert(e.message)})}function auth_build(e){let a={user:e.uid,email:e.email,login:1};firebase.database().ref("user").child(e.uid).set(a)}function auth_update(e){let a;firebase.database().ref("user/"+e.uid).once("value",s=>{a=s.val().login+1;let i={user:e.uid,email:e.email,login:a};firebase.database().ref("user").child(e.uid).set(i)})}function auth_show(){top_box_update("account"),document.getElementsByClassName("nav_list")[0].classList.remove("show"),post_list("hide"),push_list("hide"),post_edit_box("hide"),push_edit_box("hide")}
let dom_top_box;function top_box_init(){dom_top_box=document.getElementById("top_box")}function top_box_show(){dom_top_box.style.display="flex"}function top_box_hide(){dom_top_box.style.display="none"}function top_box_update(o){switch(dom_top_box.innerHTML="",o){case"station":dom_top_box.innerHTML="<div class='list-group-item list-group-item-action h-100 my-3 rounded overflow-auto'><h2>站規</h2><h3>違規行為</h3><ul><li>未經作者同意，於看板轉載他人任何形式或內容之文章。</li><li>於文章中有挑釁他人之語詞或刻意製造紛爭者。</li></ul><h3>認定處理</h3><ul><li>由版主認定。關於板主不當行為，由小組長認定。小組長管理群組不當，由站長認定。</li><li>無人擔任板主之看板，由小組長認定之。無人擔任小組長之群組，由本站認定之。</li></ul><h3>申訴程序</h3><ul><li>對於板主之建議，於該看板提出。對於小組長之建議，於該群組事務看板提出。</li></ul><h3>特別條例</h3><ul><li>站長兼任小組長兼任各版版主。</li></ul></div>";break;case"board":dom_top_box.innerHTML="<div class='list-group-item list-group-item-action h-100 my-3 rounded overflow-auto'><h4>板規</h4><ul><li>由版主自行決定。</li><li>版主休假中、小組長休假中。</li></ul></div>",dom_top_box.classList.remove("h-100"),dom_top_box.classList.add("h-25");break;case"post":firebase.database().ref(cur_room+"/"+cur_post).once("value",o=>{dom_top_box.innerHTML="<div class='h-100 my-3 rounded list-group-item list-group-item-action overflow-auto'>"+o.val().content+"</div>\n"});break;case"account":firebase.database().ref("user/"+firebase.auth().currentUser.uid).once("value",o=>{dom_top_box.innerHTML="<div class='list-group-item list-group-item-action h-100 my-3 rounded overflow-auto'><h2>帳號</h2><ul><li>"+o.val().email+"</li></ul><h2>登入次數</h2><ul><li>"+o.val().login+"</li></ul></div>"}),dom_top_box.classList.remove("h-25"),dom_top_box.classList.add("h-100")}}